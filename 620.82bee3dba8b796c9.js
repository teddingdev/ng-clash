"use strict";(self.webpackChunkng_clash=self.webpackChunkng_clash||[]).push([[620],{3620:(X,v,n)=>{n.r(v),n.d(v,{ClashProxyModule:()=>D});var c=n(1368),G=n(6688),g=n(9072),t=n(4496),f=n(5657),l=n(4704),u=n(9144),x=n(2700),O=n(1624),M=n(6700),$=n(7368),w=n(832),C=n(1476),I=n(968);let E=(()=>{class e{fetch(i){this.fetchAction$.next(i)}fetchProviders(){return this.clashApiService.fetchProvideMap().pipe((0,l.k)(i=>i.providers))}putProxy(i,o){return this.clashApiService.putProxy(i,o)}constructor(i){this.clashApiService=i,this.providers$=new f.E,this.fetchAction$=new M.g((new Date).toString()),this.proxies$=this.fetchAction$.pipe((0,$.G)(()=>this.clashApiService.fetchProxyMap().pipe((0,l.k)(({proxies:o})=>({proxies:Object.values(o).filter(a=>Object.values(C.ob).find(m=>m===a.type)),policyGroups:Object.values(o).filter(a=>Object.values(C.Qb).find(m=>m===a.type)),global:Object.values(o).filter(a=>"GLOBAL"===a.name)})))),(0,w.C)(1))}static#t=this.\u0275fac=function(o){return new(o||e)(t.CoB(I.q))};static#o=this.\u0275prov=t.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var R=n(4940),b=n(1560),p=n(4168),P=n(1725);function F(e,h){if(1&e){const i=t.KQA();t.I0R(0,"mat-chip-option",11),t.qCj("click",function(){const r=t.usT(i).$implicit,y=t.GaO().$implicit,a=t.GaO();return t.CGJ(a.handlePutProxy(y.name,r))}),t.OEk(1),t.C$Y()}if(2&e){const i=h.$implicit,o=t.GaO().$implicit;t.E7m("selected",i===o.now)("selectable",!1),t.yG2(),t.oRS(" ",i," ")}}function S(e,h){if(1&e&&(t.I0R(0,"mat-expansion-panel",null,2)(2,"mat-expansion-panel-header")(3,"mat-panel-title",3)(4,"div",4)(5,"div"),t.OEk(6),t.C$Y()(),t.I0R(7,"div",5),t.OEk(8),t.C$Y()(),t.I0R(9,"mat-panel-description")(10,"div",6),t.OEk(11),t.C$Y(),t.I0R(12,"div",7),t.OEk(13,"\u2192"),t.C$Y(),t.I0R(14,"div",8)(15,"mat-chip-option",9),t.OEk(16),t.C$Y()()()(),t.I0R(17,"mat-chip-listbox"),t.yuY(18,F,2,3,"mat-chip-option",10),t.C$Y()()),2&e){const i=h.$implicit,o=t.Gew(1);t.yG2(6),t.cNF(i.all.length),t.yG2(2),t.cNF(i.name),t.yG2(3),t.oRS("[ ",i.type," ]"),t.yG2(4),t.E7m("selectable",!1)("disabled",o.expanded),t.yG2(),t.oRS(" ",i.now," "),t.yG2(2),t.E7m("ngForOf",i.all)}}const Y=["*"];let k=(()=>{class e{constructor(){this.policyGroups=null,this.onPutProxy=new t._w7}handlePutProxy(i,o){this.onPutProxy.emit({policyName:i,proxyName:o})}static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-proxy-group"]],viewQuery:function(o,s){if(1&o&&t.CC$(p._2,5),2&o){let r;t.wto(r=t.Gqi())&&(s.accordion=r.first)}},inputs:{policyGroups:"policyGroups"},outputs:{onPutProxy:"onPutProxy"},ngContentSelectors:Y,decls:3,vars:1,consts:[["mat-accordion","","multi",""],[4,"ngFor","ngForOf"],["panel",""],[1,"title"],[1,"policy-badge"],[1,"policy-name"],[1,"policy-type"],[1,"separator"],[1,"selected"],["selected","",3,"selectable","disabled"],[3,"selected","selectable","click",4,"ngFor","ngForOf"],[3,"selected","selectable","click"]],template:function(o,s){1&o&&(t.kPM(),t._Xx(0),t.I0R(1,"div",0),t.yuY(2,S,19,7,"mat-expansion-panel",1),t.C$Y()),2&o&&(t.yG2(2),t.E7m("ngForOf",s.policyGroups))},dependencies:[c.ay,P.g3,P.QX,p._s,p.nm,p.CM,p._A],styles:[".title[_ngcontent-%COMP%]{display:flex}.policy-name[_ngcontent-%COMP%]{flex:1 0 auto}.policy-badge[_ngcontent-%COMP%]{flex:0 0 48px}.policy-badge[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:block;padding:4px;width:16px;height:16px;border-radius:40px;line-height:16px;text-align:center;font-size:14px;overflow:hidden}.policy-type[_ngcontent-%COMP%]{font-size:16px}.separator[_ngcontent-%COMP%]{margin:0 8px}.selected-light[_ngcontent-%COMP%]{opacity:.3}"]})}return e})();var d=n(2080);const j=e=>({"proxy-card-list":e});function A(e,h){if(1&e&&(t.I0R(0,"div",2)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),t.OEk(4),t.C$Y(),t.I0R(5,"mat-card-subtitle"),t.OEk(6),t.C$Y()(),t.wR5(7,"mat-card-actions",3),t.C$Y()()),2&e){const i=h.$implicit,o=t.GaO();t.E7m("ngClass",t.S45(3,j,"view_list"===o.viewModel)),t.yG2(4),t.cNF(i.type),t.yG2(2),t.cNF(i.name)}}let T=(()=>{class e{constructor(){this.proxies=null,this.viewModel="grid_view"}static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-proxy-card"]],inputs:{proxies:"proxies",viewModel:"viewModel"},decls:2,vars:1,consts:[["matRipple","",1,"proxy-card-wrap"],["class","proxy-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"proxy-card",3,"ngClass"],["align","end"]],template:function(o,s){1&o&&(t.I0R(0,"div",0),t.yuY(1,A,8,5,"div",1),t.C$Y()),2&o&&(t.yG2(),t.E7m("ngForOf",s.proxies))},dependencies:[c.QF,c.ay,d.SM,d.W0,d.Uc,d.uK,d.gp],styles:[".proxy-card-wrap[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;flex-wrap:wrap}.proxy-card[_ngcontent-%COMP%]{box-sizing:border-box;height:100%;transition:all .2s cubic-bezier(.17,.84,.44,1);width:calc(25% - 12px);margin-bottom:16px;margin-right:16px;position:relative;top:0}.proxy-card[_ngcontent-%COMP%]:nth-child(4n){margin-right:0}.proxy-card[_ngcontent-%COMP%]:hover{top:-4px}.proxy-card-list[_ngcontent-%COMP%]{width:100%;margin-right:0}"]})}return e})();const N=[{path:"",component:(()=>{class e{toggleViewModel(i){this.viewModel="grid_view"===i?"view_list":"grid_view"}putProxy(i){const{proxyName:o,policyName:s}=i;this.clashService.putProxy(o,s).subscribe(r=>{null===r?this._snackBar.open("success","close",{duration:3e3}):void 0===r&&this._snackBar.open("error","close",{duration:3e3}),this.clashService.fetch((new Date).toString())})}ngOnInit(){}ngOnDestroy(){this.stop$.next("stop")}constructor(i,o,s){this.platformId=i,this._snackBar=o,this.clashService=s,this.providers$=null,this.global$=null,this.proxies$=null,this.policyGroups$=null,this.viewModel="grid_view",this.stop$=new f.E,(0,c.c0)(this.platformId)&&(this.proxies$=this.clashService.proxies$.pipe((0,l.k)(r=>r.proxies),(0,u.a)(()=>(0,x.of)([]))),this.global$=this.clashService.proxies$.pipe((0,l.k)(r=>r.global),(0,u.a)(()=>(0,x.of)([]))),this.policyGroups$=this.clashService.proxies$.pipe((0,l.k)(r=>r.policyGroups),(0,u.a)(()=>(0,x.of)([]))),this.providers$=this.clashService.fetchProviders())}static#t=this.\u0275fac=function(o){return new(o||e)(t.GI1(t.AHE),t.GI1(O.yS),t.GI1(E))};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-clash-proxy"]],decls:14,vars:8,consts:[[1,"container"],[1,"head"],[3,"policyGroups","onPutProxy"],[1,"head-left"],[1,"head-rigt"],[1,"view-model-icon",3,"click"],["matListItemIcon",""],[3,"proxies","viewModel"]],template:function(o,s){1&o&&(t.I0R(0,"div",0)(1,"div",1),t.OEk(2,"\u7b56\u7565\u7ec4"),t.C$Y(),t.I0R(3,"app-proxy-group",2),t.qCj("onPutProxy",function(y){return s.putProxy(y)}),t.wVc(4,"async"),t.C$Y(),t.I0R(5,"div",1)(6,"div",3),t.OEk(7,"\u4ee3\u7406"),t.C$Y(),t.I0R(8,"div",4)(9,"span",5),t.qCj("click",function(){return s.toggleViewModel(s.viewModel)}),t.I0R(10,"mat-icon",6),t.OEk(11),t.C$Y()()()(),t.wR5(12,"app-proxy-card",7),t.wVc(13,"async"),t.C$Y()),2&o&&(t.yG2(3),t.E7m("policyGroups",t.kDX(4,4,s.policyGroups$)),t.yG2(8),t.cNF(s.viewModel),t.yG2(),t.E7m("proxies",t.kDX(13,6,s.proxies$))("viewModel",s.viewModel))},dependencies:[R.Y1,b.qL,k,T,c.a],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%}.head[_ngcontent-%COMP%]{margin:16px 4px;font-size:24px;height:32px;line-height:32px;display:flex}.head-right[_ngcontent-%COMP%], .head-left[_ngcontent-%COMP%]{flex:1 auto}"]})}return e})()}];let Q=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275mod=t.a4G({type:e});static#e=this.\u0275inj=t.s3X({imports:[g.qQ.forChild(N),g.qQ]})}return e})();var B=n(7344),z=n(6504);let D=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275mod=t.a4G({type:e});static#e=this.\u0275inj=t.s3X({imports:[c.MD,Q,B.MaterialModule,G.F,z.y]})}return e})()}}]);