"use strict";(self.webpackChunkng_clash=self.webpackChunkng_clash||[]).push([[732],{6688:(E,p,n)=>{n.d(p,{F:()=>i});var s=n(1368),d=n(4496);let i=(()=>{class t{static#t=this.\u0275fac=function(e){return new(e||t)};static#n=this.\u0275mod=d.a4G({type:t});static#e=this.\u0275inj=d.s3X({imports:[s.MD]})}return t})()},1732:(E,p,n)=>{n.r(p),n.d(p,{DashboardModule:()=>N});var s=n(1368),d=n(7344),i=n(9072),t=n(4496),g=n(7728),u=n(7284),e=n(3575),O=n(9892),a=n(1725),r=n(4704),m=n(832),M=n(1216),f=n(1560),R=n(7816),l=n(964),C=n(9964);let I=(()=>{class o{static#t=this.\u0275fac=function(c){return new(c||o)};static#n=this.\u0275cmp=t.In1({type:o,selectors:[["app-loading"]],decls:1,vars:0,consts:[[1,"box"]],template:function(c,v){1&c&&t.wR5(0,"div",0)},styles:['@keyframes _ngcontent-%COMP%_rotar{0%{transform:rotate(0) scaleX(.82) scaleY(.82)}50%{transform:rotate(180deg) scaleX(1) scaleY(1)}to{transform:rotate(360deg) scaleX(.82) scaleY(.82)}}@keyframes _ngcontent-%COMP%_rotarIz{0%{transform:rotate(0) scaleX(.82) scaleY(.82)}50%{transform:rotate(-180deg) scaleX(1) scaleY(1)}to{transform:rotate(-360deg) scaleX(.82) scaleY(.82)}}.box[_ngcontent-%COMP%]{margin:4px;width:24px;height:24px;position:relative;z-index:99;box-sizing:border-box}.box[_ngcontent-%COMP%]:before, .box[_ngcontent-%COMP%]:after{content:"";border-radius:66%;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:center center}.box[_ngcontent-%COMP%]:before{box-shadow:inset 0 4px #00fafa99,inset 4px 0 #00c8c899,inset -4px 0 #0096c899,inset -4px 0 #00c8fa99;animation:_ngcontent-%COMP%_rotarIz 2s -.5s linear infinite}.box[_ngcontent-%COMP%]:after{box-shadow:inset 0 4px #fafa0099,inset 4px 0 #fac80099,inset -4px 0 #fa960099,inset -4px 0 #fa640099;animation:_ngcontent-%COMP%_rotar 2s -.5s linear infinite}']})}return o})();const $=[[["","AppMenu",""]],[["","AppExtra",""]],[["","AppContent",""]]],S=["[AppMenu]","[AppExtra]","[AppContent]"];let b=(()=>{class o{ngOnInit(){}constructor(h){this.breakpointObserver=h,this.title="ng-clash",this.showSideNav=!1,this.isHandset$=this.breakpointObserver.observe(M.kP.Handset).pipe((0,r.k)(c=>c.matches),(0,m.C)())}static#t=this.\u0275fac=function(c){return new(c||o)(t.GI1(M.w$))};static#n=this.\u0275cmp=t.In1({type:o,selectors:[["app-layout"]],ngContentSelectors:S,decls:22,vars:9,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],[1,"sidenav-content"],["color","primary",1,"toolbar"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],[1,"content"]],template:function(c,v){if(1&c){const x=t.KQA();t.kPM($),t.I0R(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),t.wVc(3,"async"),t.wVc(4,"async"),t.wVc(5,"async"),t.I0R(6,"div",3)(7,"mat-toolbar"),t.wR5(8,"app-loading"),t.I0R(9,"div"),t.OEk(10,"Menu"),t.C$Y()(),t._Xx(11),t._Xx(12,1),t.C$Y()(),t.I0R(13,"mat-sidenav-content")(14,"mat-toolbar",4)(15,"button",5),t.qCj("click",function(){t.usT(x);const w=t.Gew(2);return t.CGJ(w.toggle())}),t.I0R(16,"mat-icon",6),t.OEk(17,"menu"),t.C$Y()(),t.I0R(18,"span"),t.OEk(19,"Ng-Clash"),t.C$Y()(),t.I0R(20,"div",7),t._Xx(21,2),t.C$Y()()()}2&c&&(t.yG2(),t.E7m("mode",t.kDX(4,5,v.isHandset$)?"over":"side")("opened",!1===t.kDX(5,7,v.isHandset$)),t.e48("role",t.kDX(3,3,v.isHandset$)?"dialog":"navigation"))},dependencies:[f.qL,R.um,l.EZ,C.Ar,C.WS,C.Uq,I,s.a],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{box-sizing:border-box;min-height:calc(100% - 64px);padding:0 24px 24px;position:relative}.toolbar[_ngcontent-%COMP%]{z-index:9!important}.footer[_ngcontent-%COMP%]{position:absolute;top:0}"]})}return o})();var L=n(4940);function y(o,T){if(1&o){const h=t.KQA();t.SAx(0),t.I0R(1,"mat-list-item",1),t.qCj("click",function(){const x=t.usT(h).$implicit,A=t.GaO();return t.CGJ(A.onChange.emit(x))}),t.I0R(2,"mat-icon",2),t.OEk(3),t.C$Y(),t.I0R(4,"span",3),t.OEk(5),t.C$Y()(),t.k70()}if(2&o){const h=T.$implicit;t.yG2(),t.E7m("activated",h.activated),t.yG2(2),t.cNF(h.icon),t.yG2(2),t.oRS(" ",h.name," ")}}let _=(()=>{class o{constructor(){this.navList=[],this.onChange=new t._w7}static#t=this.\u0275fac=function(c){return new(c||o)};static#n=this.\u0275cmp=t.In1({type:o,selectors:[["app-menu"]],viewQuery:function(c,v){if(1&c&&t.CC$(L.IJ,5),2&c){let x;t.wto(x=t.Gqi())&&(v.matSelectionList=x.first)}},inputs:{navList:"navList"},outputs:{onChange:"onChange"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"activated","click"],["matListItemIcon",""],["matListItemTitle",""]],template:function(c,v){1&c&&(t.I0R(0,"mat-nav-list"),t.yuY(1,y,6,3,"ng-container",0),t.C$Y()),2&c&&(t.yG2(),t.E7m("ngForOf",v.navList))},dependencies:[s.ay,L.G2,L.g9,L.Y1,L.UV,f.qL]})}return o})();function B(o,T){1&o&&(t.I0R(0,"div")(1,"mat-chip",8),t.OEk(2,"Premium"),t.C$Y()()),2&o&&(t.yG2(),t.E7m("highlighted",!0))}let K=(()=>{class o{handleSideNavActive(h){this.navList=this.toggleSideNavActiveStatus(this.navList,c=>c.value===h.value),this.router.navigate([h.value],{relativeTo:this.route})}toggleSideNavActiveStatus(h,c){return h.map(v=>(v.activated=!!c(v),v))}ngOnInit(){(0,s.c0)(this.platformId)&&(this.navList=this.toggleSideNavActiveStatus(this.navList,h=>location.pathname.includes(h.value))),(0,s.c0)(this.platformId)&&this.logService.initLog(),this.connectionService.initConnection(),(0,s.c0)(this.platformId)&&this.storeService.clashVersion$.subscribe(h=>this.clashVersion=h)}constructor(h,c,v,x,A,w){this.platformId=h,this.router=c,this.route=v,this.logService=x,this.storeService=A,this.connectionService=w,this.navList=[{name:"\u4ee3\u7406",value:g.v.proxies,icon:"vpn_key",activated:!0},{name:"\u65e5\u5fd7",value:g.v.logs,icon:"terminal",activated:!1},{name:"\u89c4\u5219",value:g.v.rules,icon:"rule",activated:!1},{name:"\u8fde\u63a5",value:g.v.links,icon:"link",activated:!1},{name:"\u8bbe\u7f6e",value:g.v.settings,icon:"settings",activated:!1}],this.githubPages="https://github.com/teddingdev/ng-clash/actions/workflows/github-pages.yml/badge.svg",this.pagesBuildDeployment="https://github.com/teddingdev/ng-clash/actions/workflows/pages/pages-build-deployment/badge.svg",this.clashVersion=null}static#t=this.\u0275fac=function(c){return new(c||o)(t.GI1(t.AHE),t.GI1(i.E5),t.GI1(i.gV),t.GI1(u.w),t.GI1(e.a),t.GI1(O.k))};static#n=this.\u0275cmp=t.In1({type:o,selectors:[["app-dashboard"]],decls:13,vars:4,consts:[["AppMenu",""],["AppMenu","",3,"navList","onChange"],[1,"app-extra"],[1,"version"],[4,"ngIf"],[1,"CI-status"],["alt","github-pages-badge.svg",3,"src"],["AppContent",""],[3,"highlighted"]],template:function(c,v){1&c&&(t.I0R(0,"app-layout"),t.SAx(1,0),t.I0R(2,"app-menu",1),t.qCj("onChange",function(A){return v.handleSideNavActive(A)}),t.C$Y(),t.I0R(3,"div",2)(4,"div",3)(5,"div"),t.OEk(6,"CLASH VERSION"),t.C$Y(),t.I0R(7,"div"),t.OEk(8),t.C$Y(),t.yuY(9,B,3,1,"div",4),t.C$Y(),t.I0R(10,"div",5),t.wR5(11,"img",6),t.C$Y()(),t.k70(),t.wR5(12,"router-outlet",7),t.C$Y()),2&c&&(t.yG2(2),t.E7m("navList",v.navList),t.yG2(6),t.oRS(" ",null==v.clashVersion?null:v.clashVersion.version," "),t.yG2(),t.E7m("ngIf",null==v.clashVersion?null:v.clashVersion.premium),t.yG2(2),t.E7m("src",v.githubPages,t.K6U))},dependencies:[s.u_,i.cP,a.oH,b,_],styles:[".app-extra[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:flex-end;align-items:center}.app-extra[_ngcontent-%COMP%]   .version[_ngcontent-%COMP%]{text-align:center;margin-bottom:8px;line-height:28px;font-size:14px}.app-extra[_ngcontent-%COMP%]   .CI-status[_ngcontent-%COMP%]{margin-bottom:8px}"]})}return o})();var D=n(1476);const P=[{path:"",component:K,children:[{path:"",redirectTo:D.v0.proxies,pathMatch:"full"},{path:D.v0.proxies,loadChildren:()=>n.e(620).then(n.bind(n,3620)).then(o=>o.ClashProxyModule)},{path:D.v0.rules,loadChildren:()=>Promise.all([n.e(312),n.e(392)]).then(n.bind(n,7392)).then(o=>o.ClashRulesModule)},{path:D.v0.logs,loadChildren:()=>n.e(435).then(n.bind(n,5435)).then(o=>o.ClashLogsModule)},{path:D.v0.links,loadChildren:()=>n.e(420).then(n.bind(n,3420)).then(o=>o.ClashLinksModule)},{path:D.v0.settings,loadChildren:()=>Promise.all([n.e(312),n.e(996)]).then(n.bind(n,6996)).then(o=>o.ClashSettingsModule)}]}];let U=(()=>{class o{static#t=this.\u0275fac=function(c){return new(c||o)};static#n=this.\u0275mod=t.a4G({type:o});static#e=this.\u0275inj=t.s3X({imports:[i.qQ.forChild(P),i.qQ]})}return o})();var G=n(6688);let N=(()=>{class o{static#t=this.\u0275fac=function(c){return new(c||o)};static#n=this.\u0275mod=t.a4G({type:o});static#e=this.\u0275inj=t.s3X({imports:[s.MD,U,d.MaterialModule,G.F]})}return o})()},7728:(E,p,n)=>{n.d(p,{v:()=>s});var s=function(d){return d.proxies="proxies",d.logs="logs",d.rules="rules",d.links="links",d.settings="settings",d}(s||{})},1476:(E,p,n)=>{n.d(p,{ee:()=>g,v0:()=>u.v,Qb:()=>t,ob:()=>d,pf:()=>s});var s=function(e){return e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED",e}(s||{}),d=function(e){return e.Shadowsocks="Shadowsocks",e.Vmess="Vmess",e.Trojan="Trojan",e.Socks="Socks",e.Http="Http",e.Snell="Snell",e}(d||{}),t=function(e){return e.Selector="Selector",e.URLTest="URLTest",e.Fallback="Fallback",e.LoadBalance="LoadBalance",e}(t||{}),g=function(e){return e.global="Global",e.rule="Rule",e.script="Script",e.direct="Direct",e}(g||{}),u=n(7728)},968:(E,p,n)=>{n.d(p,{q:()=>u});var s=n(9144),d=n(2700),i=n(4496),t=n(7048),g=n(4184);let u=(()=>{class e{get hostname(){return this.hostService.hostname}fetchProxyMap(){return this.http.get(`${this.hostname}/proxies`).pipe((0,s.a)(r=>(console.log(r),[])))}fetchProvideMap(){return this.http.get(`${this.hostname}/providers/proxies`)}putProxy(a,r){return this.http.put(`${this.hostname}/proxies/${r}`,{name:a}).pipe((0,s.a)(M=>(console.log(M),(0,d.of)(void 0))))}fetchConfig(){return this.http.get(`${this.hostname}/configs`)}putConfig(a){return this.http.put(`${this.hostname}/configs`,a).pipe((0,s.a)(m=>(console.log(m),(0,d.of)(void 0))))}patchConfig(a){return this.http.patch(`${this.hostname}/configs`,a).pipe((0,s.a)(m=>(console.log(m),(0,d.of)(void 0))))}fetchRules(){const a=`${this.hostname}/rules`;return console.log("\u{1f345} -> file: clash-api.service.ts:58 -> ClashApiService -> fetchRules -> this.hostname:",this.hostname),console.log("\u{1f345} -> file: clash-api.service.ts:58 -> ClashApiService -> fetchRules -> url:",a),this.http.get(a)}fetchVersion(){return this.http.get(`${this.hostname}/version`)}constructor(a,r){this.http=a,this.hostService=r}static#t=this.\u0275fac=function(r){return new(r||e)(i.CoB(t.KK),i.CoB(g.M))};static#n=this.\u0275prov=i.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},4184:(E,p,n)=>{n.d(p,{M:()=>d});var s=n(4496);let d=(()=>{class i{get externalControlConfig(){return{hostname:"localhost",port:"7891",key:""}}set externalControlConfig(g){JSON.parse("").externalControl=g}get host(){return this.externalControlConfig.hostname}get port(){return this.externalControlConfig.port}get hostname(){return`http://${this.host}:${this.port}`}constructor(){}static#t=this.\u0275fac=function(u){return new(u||i)};static#n=this.\u0275prov=s.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},8508:(E,p,n)=>{n.d(p,{S:()=>s.S});var s=n(6860)},3575:(E,p,n)=>{n.d(p,{a:()=>g});var s=n(5657),d=n(7368),i=n(4496),t=n(968);let g=(()=>{class u{configExpired(){this.dashboardConfigSubject.next("new config")}fetchVersion(){}constructor(O){this.clashApiService=O,this.dashboardConfigSubject=new s.E,this.dashboardConfig$=this.dashboardConfigSubject.pipe((0,d.G)(()=>this.clashApiService.fetchConfig())),this.clashVersion$=this.clashApiService.fetchVersion()}static#t=this.\u0275fac=function(a){return new(a||u)(i.CoB(t.q))};static#n=this.\u0275prov=i.wxM({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},6860:(E,p,n)=>{n.d(p,{S:()=>d});var s=n(1476);class d{constructor(t){this.connected=()=>{const r=this.instance;return!!r&&(r.readyState===s.pf.CONNECTING||r.readyState===s.pf.OPEN)},this.onClose=()=>{const r=this.instance;!r||!this.connected||(r.close(),this.instance=null)},this.onopen=r=>{console.log("webSocket \u5df2\u8fde\u63a5")},this.onclose=r=>{console.log("webSocket \u5df2\u5173\u95ed")},this.onmessage=r=>{},this.onerror=r=>{console.log(r)},this.send=r=>{this.instance&&this.instance.send(JSON.stringify(r))};const{url:g,onopen:u,onerror:e,onclose:O,onmessage:a}=t;this.instance=new WebSocket(g),this.instance.onopen=u||this.onopen,this.instance.onerror=e||this.onerror,this.instance.onclose=O||this.onclose,this.instance.onmessage=a||this.onmessage}}},9892:(E,p,n)=>{n.d(p,{k:()=>u});var s=n(4496),d=n(5657),i=n(8508),t=n(1368),g=n(4184);let u=(()=>{class e{initConnection(){this.connection$.subscribe(a=>{this.connectionList=a})}constructor(a,r){this.platformId=a,this.hostService=r,this.connection$=new d.E,this.connectionList=null;const f=`ws://${this.hostService.host}:${this.hostService.port}/connections`;(0,t.c0)(a)&&new i.S({url:f,onmessage:l=>{let C=null;try{C=JSON.parse(l.data)}catch(I){console.log(I)}C&&this.connection$.next(C)}}).connected()}static#t=this.\u0275fac=function(r){return new(r||e)(s.CoB(s.AHE),s.CoB(g.M))};static#n=this.\u0275prov=s.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},7284:(E,p,n)=>{n.d(p,{w:()=>M});var s=n(4496),d=n(208),i=n(4704),t=n(9144),g=n(2700),u=n(5657),e=n(6860),O=n(1368),a=n(4184);const m=()=>(0,d.K)((f,R)=>(f.unshift(R),f),[]);let M=(()=>{class f{initLog(){this.debug$.pipe((0,i.k)(l=>JSON.parse(l)),(0,i.k)(l=>({...l,time:new Date})),m(),(0,t.a)(()=>(0,g.of)([]))).subscribe(l=>{this.debugLog=l}),this.info$.pipe((0,i.k)(l=>JSON.parse(l)),(0,i.k)(l=>({...l,time:new Date})),m(),(0,t.a)(()=>(0,g.of)([]))).subscribe(l=>{this.infoLog=l}),this.warn$.pipe((0,i.k)(l=>JSON.parse(l)),(0,i.k)(l=>({...l,time:new Date})),m(),(0,t.a)(()=>(0,g.of)([]))).subscribe(l=>{this.warnLog=l}),this.error$.pipe((0,i.k)(l=>JSON.parse(l)),(0,i.k)(l=>({...l,time:new Date})),m(),(0,t.a)(()=>(0,g.of)([]))).subscribe(l=>{this.errorLog=l})}constructor(l,C){this.platformId=l,this.hostService=C,this.debug$=new u.E,this.info$=new u.E,this.warn$=new u.E,this.error$=new u.E,this.debugLog=[],this.infoLog=[],this.warnLog=[],this.errorLog=[];const I=this.hostService.host,$=this.hostService.port,S=`ws://${I}:${$}/logs?level=info`,b=`ws://${I}:${$}/logs?level=warn`,L=`ws://${I}:${$}/logs?level=debug`,y=`ws://${I}:${$}/logs?level=error`;if((0,O.c0)(l)){const _=new e.S({url:L,onmessage:P=>{this.debug$.next(P.data)}}),B=new e.S({url:S,onmessage:P=>{this.info$.next(P.data)}}),K=new e.S({url:b,onmessage:P=>{this.warn$.next(P.data)}}),D=new e.S({url:y,onmessage:P=>{this.error$.next(P.data)}});_.connected(),B.connected(),K.connected(),D.connected()}}static#t=this.\u0275fac=function(C){return new(C||f)(s.CoB(s.AHE),s.CoB(a.M))};static#n=this.\u0275prov=s.wxM({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()}}]);