"use strict";(self.webpackChunkng_clash=self.webpackChunkng_clash||[]).push([[996],{6996:(B,C,a)=>{a.r(C),a.d(C,{ClashSettingsModule:()=>A});var r=a(1368),l=a(6504),E=a(7344),m=a(9072),t=a(4496),f=a(4184),b=a(3575),p=a(1476),d=a(2864),s=a(2080),g=a(7536),c=a(4060),h=a(7816);let F=(()=>{class o{onCancel(){this.dialogRef.close()}onConfirm(){this.dialogRef.close(this.validateForm.value)}constructor(i,n,e){this.fb=i,this.dialogRef=n,this.data=e,this.validateForm=this.fb.group({hostname:[],port:[],key:[]}),this.validateForm.patchValue(this.data)}static#t=this.\u0275fac=function(n){return new(n||o)(t.GI1(l.im),t.GI1(d.yI),t.GI1(d.sR))};static#o=this.\u0275cmp=t.In1({type:o,selectors:[["app-settings-control"]],decls:39,vars:1,consts:[[3,"formGroup"],[1,"flex-box"],[1,"flex-item"],[1,"label"],[1,"control"],["mat-form-field","","appearance","fill"],["matInput","","formControlName","hostname"],["matInput","","formControlName","port"],["matInput","","formControlName","key"],[1,"tip"],[1,"actions"],["type","button","mat-raised-button","",1,"action",3,"click"],["type","button","mat-raised-button","","color","primary",1,"action",3,"click"]],template:function(n,e){1&n&&(t.I0R(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.OEk(3," \u5916\u90e8\u63a7\u5236\u8bbe\u7f6e "),t.C$Y()(),t.I0R(4,"mat-card-content")(5,"form",0)(6,"div",1)(7,"div",2)(8,"div",3),t.OEk(9,"\u4e3b\u673a\u540d"),t.C$Y(),t.I0R(10,"div",4)(11,"div",5)(12,"mat-label"),t.OEk(13,"\u4e3b\u673a\u540d"),t.C$Y(),t.wR5(14,"input",6),t.C$Y()()(),t.I0R(15,"div",2)(16,"div",3),t.OEk(17,"\u7aef\u53e3"),t.C$Y(),t.I0R(18,"div",4)(19,"div",5)(20,"mat-label"),t.OEk(21,"\u7aef\u53e3"),t.C$Y(),t.wR5(22,"input",7),t.C$Y()()(),t.I0R(23,"div",2)(24,"div",3),t.OEk(25,"\u5bc6\u94a5"),t.C$Y(),t.I0R(26,"div",4)(27,"div",5)(28,"mat-label"),t.OEk(29,"\u5bc6\u94a5"),t.C$Y(),t.wR5(30,"input",8),t.C$Y()()()()()(),t.I0R(31,"mat-card-footer")(32,"div",9),t.OEk(33," \u8bf7\u6ce8\u610f\uff0c\u4fee\u6539\u8be5\u914d\u7f6e\u9879\u5e76\u4e0d\u4f1a\u4fee\u6539\u4f60\u7684 Clash \u914d\u7f6e\u6587\u4ef6\uff0c\u8bf7\u786e\u8ba4\u4fee\u6539\u540e\u7684\u5916\u90e8\u63a7\u5236\u5730\u5740\u548c Clash \u914d\u7f6e\u6587\u4ef6\u5185\u7684\u5730\u5740\u4e00\u81f4\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4 Dashboard \u65e0\u6cd5\u8fde\u63a5\u3002 "),t.C$Y()(),t.I0R(34,"mat-card-actions",10)(35,"button",11),t.qCj("click",function(){return e.onCancel()}),t.OEk(36,"\u53d6\u6d88"),t.C$Y(),t.I0R(37,"button",12),t.qCj("click",function(){return e.onConfirm()}),t.OEk(38,"\u786e\u5b9a"),t.C$Y()()()),2&n&&(t.yG2(5),t.E7m("formGroup",e.validateForm))},dependencies:[l.sz,l.ot,l.ue,l.u,l.uW,l.Wo,s.SM,s.W0,s.WK,s.Yr,s.Uc,s.gp,g.yi,c.w5,h.Gw],styles:[".flex-box[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.flex-item[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:calc(100% + -0px);margin:0;display:flex;justify-content:space-between;align-items:center}.flex-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:16px}.tip[_ngcontent-%COMP%]{margin:8px 16px;padding:8px 16px;border-left:4px solid;color:#00000050}.actions[_ngcontent-%COMP%]{justify-content:flex-end}.action[_ngcontent-%COMP%]{margin:0 8px}"]})}return o})();var I=a(6684),R=a(1624),x=a(5618),y=a(1560),O=a(7760),v=a(1976);function $(o,G){if(1&o&&(t.I0R(0,"mat-button-toggle",20),t.OEk(1),t.C$Y()),2&o){const i=G.$implicit;t.E7m("value",i.key),t.yG2(),t.oRS(" ",i.value," ")}}function Y(o){return null!=o}let k=(()=>{class o{set dashboardConfig(i){i&&this.validateForm.reset(i),this._dashboardConfig=i}get dashboardConfig(){return this._dashboardConfig}openDialog(){this.dialog.open(F,{width:"600px",data:this.externalControlConfig}).afterClosed().pipe((0,I.I)(Y)).subscribe(n=>{n&&(this.hostService.externalControlConfig=n)})}save(){const{mode:i,...n}=this.validateForm.value;this.clashApiService.patchConfig({...n,mode:p.ee[i]}).subscribe(e=>{null===e?(this._snackBar.open("success","close",{duration:3e3}),this.validateForm.reset(this.validateForm.value),this.updateDashboardConfig.emit("")):void 0===e&&this._snackBar.open("error","close",{duration:3e3})})}KVCompareFn(i,n){return 0}ngOnInit(){}constructor(i,n,e,u,M){this.fb=i,this.dialog=n,this._snackBar=e,this.hostService=u,this.clashApiService=M,this._dashboardConfig=null,this.externalControlConfig=null,this.updateDashboardConfig=new t._w7,this.clashMode=p.ee,this.change=new t._w7,this.validateForm=this.fb.group({port:[null],"socks-port":[null],"redir-port":[null],"tproxy-port":[null],"mixed-port":[null],"allow-lan":[null],"bind-address":[null],"log-level":[null],mode:[null],ipv6:[null]})}static#t=this.\u0275fac=function(n){return new(n||o)(t.GI1(l.im),t.GI1(d.qW),t.GI1(R.yS),t.GI1(f.M),t.GI1(x.qe))};static#o=this.\u0275cmp=t.In1({type:o,selectors:[["app-settings"]],inputs:{dashboardConfig:"dashboardConfig",externalControlConfig:"externalControlConfig"},outputs:{updateDashboardConfig:"updateDashboardConfig",change:"change"},decls:79,vars:8,consts:[[1,"container"],[3,"formGroup"],[1,"flex-box"],[1,"flex-item"],[1,"label"],[1,"control"],["labelPosition","before","disabled",""],["name","fontStyle","aria-label","Font Style"],["value","bold"],["value","italic"],["formControlName","allow-lan","labelPosition","before"],["formControlName","mode"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","type","number","formControlName","socks-port"],["matInput","","type","number","formControlName","redir-port"],["matInput","","type","number","formControlName","mixed-port"],[1,"external-config",3,"click"],[1,"save"],["mat-fab","",3,"color","click"],[3,"value"]],template:function(n,e){1&n&&(t.I0R(0,"div",0)(1,"form",1)(2,"mat-card")(3,"mat-card-content")(4,"div",2)(5,"div",3)(6,"div",4),t.OEk(7,"\u5f00\u673a\u65f6\u542f\u52a8"),t.C$Y(),t.I0R(8,"div",5),t.wR5(9,"mat-slide-toggle",6),t.C$Y()(),t.I0R(10,"div",3)(11,"div",4),t.OEk(12,"\u8bed\u8a00"),t.C$Y(),t.I0R(13,"div",5)(14,"mat-button-toggle-group",7)(15,"mat-button-toggle",8),t.OEk(16,"\u4e2d\u6587"),t.C$Y(),t.I0R(17,"mat-button-toggle",9),t.OEk(18,"English"),t.C$Y()()()(),t.I0R(19,"div",3)(20,"div",4),t.OEk(21,"\u8bbe\u4e3a\u7cfb\u7edf\u4ee3\u7406"),t.C$Y(),t.I0R(22,"div",5),t.wR5(23,"mat-slide-toggle",6),t.C$Y()(),t.I0R(24,"div",3)(25,"div",4),t.OEk(26,"\u5141\u8bb8\u6765\u81ea\u5c40\u57df\u7f51\u7684\u8fde\u63a5"),t.C$Y(),t.I0R(27,"div",5),t.wR5(28,"mat-slide-toggle",10),t.C$Y()()()()(),t.wR5(29,"br"),t.I0R(30,"mat-card")(31,"mat-card-content")(32,"div",2)(33,"div",3)(34,"div",4),t.OEk(35,"\u4ee3\u7406\u6a21\u5f0f"),t.C$Y(),t.I0R(36,"div",5)(37,"mat-button-toggle-group",11),t.yuY(38,$,2,2,"mat-button-toggle",12),t.wVc(39,"keyvalue"),t.C$Y()()(),t.I0R(40,"div",3)(41,"div",4),t.OEk(42,"Socks5 \u4ee3\u7406\u7aef\u53e3"),t.C$Y(),t.I0R(43,"div",5)(44,"mat-form-field",13)(45,"mat-label"),t.OEk(46,"Socks5 \u4ee3\u7406\u7aef\u53e3"),t.C$Y(),t.wR5(47,"input",14),t.C$Y()()(),t.I0R(48,"div",3)(49,"div",4),t.OEk(50,"HTTP \u4ee3\u7406\u7aef\u53e3"),t.C$Y(),t.I0R(51,"div",5)(52,"mat-form-field",13)(53,"mat-label"),t.OEk(54,"HTTP \u4ee3\u7406\u7aef\u53e3"),t.C$Y(),t.wR5(55,"input",15),t.C$Y()()(),t.I0R(56,"div",3)(57,"div",4),t.OEk(58,"\u6df7\u5408\u4ee3\u7406\u7aef\u53e3"),t.C$Y(),t.I0R(59,"div",5)(60,"mat-form-field",13)(61,"mat-label"),t.OEk(62,"\u6df7\u5408\u4ee3\u7406\u7aef\u53e3"),t.C$Y(),t.wR5(63,"input",16),t.C$Y()()(),t.I0R(64,"div",3)(65,"div",4),t.OEk(66,"\u5916\u90e8\u63a7\u5236\u8bbe\u7f6e"),t.C$Y(),t.I0R(67,"div",5)(68,"div",17),t.qCj("click",function(){return e.openDialog()}),t.I0R(69,"span"),t.OEk(70),t.C$Y(),t.I0R(71,"span"),t.OEk(72,":"),t.C$Y(),t.I0R(73,"span"),t.OEk(74),t.C$Y()()()()()()()(),t.I0R(75,"div",18)(76,"button",19),t.qCj("click",function(){return e.save()}),t.I0R(77,"mat-icon"),t.OEk(78,"save"),t.C$Y()()()()),2&n&&(t.yG2(),t.E7m("formGroup",e.validateForm),t.yG2(37),t.E7m("ngForOf",t.g7$(39,5,e.clashMode,e.KVCompareFn)),t.yG2(32),t.cNF(null==e.externalControlConfig?null:e.externalControlConfig.hostname),t.yG2(4),t.cNF(null==e.externalControlConfig?null:e.externalControlConfig.port),t.yG2(2),t.E7m("color",e.validateForm.pristine?"primary":"accent"))},dependencies:[r.ay,l.sz,l.ot,l.O4,l.ue,l.u,l.uW,l.Wo,s.SM,s.WK,y.qL,g.yi,c.Up,c.w5,h.uw,O.cP,v.gn,v.KU,r.uq],styles:[".flex-box[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.flex-item[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:calc(50% - 16px);margin:0 8px 8px;display:flex;justify-content:space-between;align-items:center}.flex-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:16px}.external-config[_ngcontent-%COMP%]{font-size:16px;cursor:pointer;text-decoration:underline}.save[_ngcontent-%COMP%]{margin-top:24px;display:flex;justify-content:flex-end}"]})}return o})();const S=[{path:"",component:(()=>{class o{get externalControlConfig(){return this.hostService.externalControlConfig}updateDashboardConfig(){this.storeService.configExpired()}ngOnInit(){this.updateDashboardConfig(),(0,r.c0)(this.platformId)&&this.storeService.dashboardConfig$.subscribe(i=>{this.dashboardConfig=i})}constructor(i,n,e){this.platformId=i,this.hostService=n,this.storeService=e,this.dashboardConfig=null}static#t=this.\u0275fac=function(n){return new(n||o)(t.GI1(t.AHE),t.GI1(f.M),t.GI1(b.a))};static#o=this.\u0275cmp=t.In1({type:o,selectors:[["app-clash-settings"]],decls:1,vars:2,consts:[[3,"dashboardConfig","externalControlConfig","updateDashboardConfig"]],template:function(n,e){1&n&&(t.I0R(0,"app-settings",0),t.qCj("updateDashboardConfig",function(){return e.updateDashboardConfig()}),t.C$Y()),2&n&&t.E7m("dashboardConfig",e.dashboardConfig)("externalControlConfig",e.externalControlConfig)},dependencies:[k]})}return o})()}];let D=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#o=this.\u0275mod=t.a4G({type:o});static#n=this.\u0275inj=t.s3X({imports:[m.qQ.forChild(S),m.qQ]})}return o})(),A=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#o=this.\u0275mod=t.a4G({type:o});static#n=this.\u0275inj=t.s3X({imports:[r.MD,l.y,l.sl,D,E.MaterialModule]})}return o})()}}]);