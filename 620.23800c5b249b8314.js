"use strict";(self.webpackChunkng_clash=self.webpackChunkng_clash||[]).push([[620],{3620:(D,f,i)=>{i.r(f),i.d(f,{ClashProxyModule:()=>B});var c=i(1368),O=i(6688),g=i(9072),t=i(4496),v=i(5657),p=i(4704),x=i(9144),u=i(2700),M=i(1624),G=i(6700),$=i(7368),w=i(832),C=i(1476),b=i(968);let I=(()=>{class e{fetch(n){this.fetchAction$.next(n)}fetchProviders(){return this.clashApiService.fetchProvideMap().pipe((0,p.k)(n=>n.providers))}putProxy(n,o){return this.clashApiService.putProxy(n,o)}constructor(n){this.clashApiService=n,this.providers$=new v.E,this.fetchAction$=new G.g((new Date).toString()),this.proxies$=this.fetchAction$.pipe((0,$.G)(()=>this.clashApiService.fetchProxyMap().pipe((0,p.k)(({proxies:o})=>({proxies:Object.values(o).filter(s=>Object.values(C.ob).find(m=>m===s.type)),policyGroups:Object.values(o).filter(s=>Object.values(C.Qb).find(m=>m===s.type)),global:Object.values(o).filter(s=>"GLOBAL"===s.name)})))),(0,w.C)(1))}static#t=this.\u0275fac=function(o){return new(o||e)(t.CoB(b.q))};static#o=this.\u0275prov=t.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var E=i(4940),R=i(1560),l=i(4168),P=i(1725);function k(e,h){if(1&e){const n=t.KQA();t.I0R(0,"mat-chip-option",11),t.qCj("click",function(){const a=t.usT(n).$implicit,y=t.GaO().$implicit,s=t.GaO();return t.CGJ(s.handlePutProxy(y.name,a))}),t.OEk(1),t.C$Y()}if(2&e){const n=h.$implicit,o=t.GaO().$implicit;t.E7m("selected",n===o.now)("selectable",!1),t.yG2(),t.oRS(" ",n," ")}}function F(e,h){if(1&e&&(t.I0R(0,"mat-expansion-panel",null,2)(2,"mat-expansion-panel-header")(3,"mat-panel-title",3)(4,"div",4)(5,"div"),t.OEk(6),t.C$Y()(),t.I0R(7,"div",5),t.OEk(8),t.C$Y()(),t.I0R(9,"mat-panel-description")(10,"div",6),t.OEk(11),t.C$Y(),t.I0R(12,"div",7),t.OEk(13,"\u2192"),t.C$Y(),t.I0R(14,"div",8)(15,"mat-chip-option",9),t.OEk(16),t.C$Y()()()(),t.I0R(17,"mat-chip-listbox"),t.yuY(18,k,2,3,"mat-chip-option",10),t.C$Y()()),2&e){const n=h.$implicit,o=t.Gew(1);t.yG2(6),t.cNF(n.all.length),t.yG2(2),t.cNF(n.name),t.yG2(3),t.oRS("[ ",n.type," ]"),t.yG2(4),t.E7m("selectable",!1)("disabled",o.expanded),t.yG2(),t.oRS(" ",n.now," "),t.yG2(2),t.E7m("ngForOf",n.all)}}const S=["*"];let Y=(()=>{class e{constructor(){this.policyGroups=null,this.onPutProxy=new t._w7}handlePutProxy(n,o){this.onPutProxy.emit({policyName:n,proxyName:o})}static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-proxy-group"]],viewQuery:function(o,r){if(1&o&&t.CC$(l._2,5),2&o){let a;t.wto(a=t.Gqi())&&(r.accordion=a.first)}},inputs:{policyGroups:"policyGroups"},outputs:{onPutProxy:"onPutProxy"},ngContentSelectors:S,decls:3,vars:1,consts:[["mat-accordion","","multi",""],[4,"ngFor","ngForOf"],["panel",""],[1,"title"],[1,"policy-badge"],[1,"policy-name"],[1,"policy-type"],[1,"separator"],[1,"selected"],["selected","",3,"selectable","disabled"],[3,"selected","selectable","click",4,"ngFor","ngForOf"],[3,"selected","selectable","click"]],template:function(o,r){1&o&&(t.kPM(),t._Xx(0),t.I0R(1,"div",0),t.yuY(2,F,19,7,"mat-expansion-panel",1),t.C$Y()),2&o&&(t.yG2(2),t.E7m("ngForOf",r.policyGroups))},dependencies:[c.ay,P.g3,P.QX,l._s,l.nm,l.CM,l._A],styles:[".title[_ngcontent-%COMP%]{display:flex}.policy-name[_ngcontent-%COMP%]{flex:1 0 auto}.policy-badge[_ngcontent-%COMP%]{flex:0 0 48px}.policy-badge[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:block;padding:4px;width:16px;height:16px;border-radius:40px;line-height:16px;text-align:center;font-size:14px;overflow:hidden;color:#fff;background-color:#f06292}@media (prefers-color-scheme: dark){.policy-badge[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{background-color:#90a4ae}}.policy-type[_ngcontent-%COMP%]{font-size:16px}.separator[_ngcontent-%COMP%]{margin:0 8px}.selected-light[_ngcontent-%COMP%]{opacity:.3}"]})}return e})();var d=i(2080);const j=e=>({"proxy-card-list":e});function _(e,h){if(1&e&&(t.I0R(0,"div",2)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),t.OEk(4),t.C$Y(),t.I0R(5,"mat-card-subtitle"),t.OEk(6),t.C$Y()(),t.wR5(7,"mat-card-actions",3),t.C$Y()()),2&e){const n=h.$implicit,o=t.GaO();t.E7m("ngClass",t.S45(3,j,"view_list"===o.viewModel)),t.yG2(4),t.cNF(n.type),t.yG2(2),t.cNF(n.name)}}let A=(()=>{class e{constructor(){this.proxies=null,this.viewModel="grid_view"}static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-proxy-card"]],inputs:{proxies:"proxies",viewModel:"viewModel"},decls:2,vars:1,consts:[["matRipple","",1,"proxy-card-wrap"],["class","proxy-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"proxy-card",3,"ngClass"],["align","end"]],template:function(o,r){1&o&&(t.I0R(0,"div",0),t.yuY(1,_,8,5,"div",1),t.C$Y()),2&o&&(t.yG2(),t.E7m("ngForOf",r.proxies))},dependencies:[c.QF,c.ay,d.SM,d.W0,d.Uc,d.uK,d.gp],styles:['.proxy-card-wrap[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;flex-wrap:wrap}.proxy-card[_ngcontent-%COMP%]{box-sizing:border-box;height:100%;transition:all .2s cubic-bezier(.17,.84,.44,1);width:calc(25% - 12px);margin-bottom:16px;margin-right:16px;position:relative;top:0}.proxy-card[_ngcontent-%COMP%]:nth-child(4n){margin-right:0}.proxy-card[_ngcontent-%COMP%]:hover{top:-4px}.proxy-card[_ngcontent-%COMP%]:after, .proxy-card[_ngcontent-%COMP%]:before{position:absolute;content:"";width:50%;max-width:300px;height:20%;top:70%;transition:all .2s cubic-bezier(.17,.84,.44,1);z-index:-1}.proxy-card[_ngcontent-%COMP%]:before{transform:rotate(-4deg);left:14px}.proxy-card[_ngcontent-%COMP%]:after{transform:rotate(4deg);right:14px}.proxy-card[_ngcontent-%COMP%]:hover:after, .proxy-card[_ngcontent-%COMP%]:hover:before{box-shadow:0 8px 12px 4px #3949ab}@media (prefers-color-scheme: dark){.proxy-card[_ngcontent-%COMP%]:hover:after, .proxy-card[_ngcontent-%COMP%]:hover:before{box-shadow:0 8px 12px 4px #d81b60}}.proxy-card-list[_ngcontent-%COMP%]{width:100%;margin-right:0}']})}return e})();const T=[{path:"",component:(()=>{class e{toggleViewModel(n){this.viewModel="grid_view"===n?"view_list":"grid_view"}putProxy(n){const{proxyName:o,policyName:r}=n;this.clashService.putProxy(o,r).subscribe(a=>{null===a?this._snackBar.open("success","close",{duration:3e3}):void 0===a&&this._snackBar.open("error","close",{duration:3e3}),this.clashService.fetch((new Date).toString())})}ngOnInit(){}ngOnDestroy(){this.stop$.next("stop")}constructor(n,o,r){this.platformId=n,this._snackBar=o,this.clashService=r,this.providers$=null,this.global$=null,this.proxies$=null,this.policyGroups$=null,this.viewModel="grid_view",this.stop$=new v.E,(0,c.c0)(this.platformId)&&(this.proxies$=this.clashService.proxies$.pipe((0,p.k)(a=>a.proxies),(0,x.a)(()=>(0,u.of)([]))),this.global$=this.clashService.proxies$.pipe((0,p.k)(a=>a.global),(0,x.a)(()=>(0,u.of)([]))),this.policyGroups$=this.clashService.proxies$.pipe((0,p.k)(a=>a.policyGroups),(0,x.a)(()=>(0,u.of)([]))),this.providers$=this.clashService.fetchProviders())}static#t=this.\u0275fac=function(o){return new(o||e)(t.GI1(t.AHE),t.GI1(M.yS),t.GI1(I))};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-clash-proxy"]],decls:14,vars:8,consts:[[1,"container"],[1,"head"],[3,"policyGroups","onPutProxy"],[1,"head-left"],[1,"head-rigt"],[1,"view-model-icon",3,"click"],["matListItemIcon",""],[3,"proxies","viewModel"]],template:function(o,r){1&o&&(t.I0R(0,"div",0)(1,"div",1),t.OEk(2,"\u7b56\u7565\u7ec4"),t.C$Y(),t.I0R(3,"app-proxy-group",2),t.qCj("onPutProxy",function(y){return r.putProxy(y)}),t.wVc(4,"async"),t.C$Y(),t.I0R(5,"div",1)(6,"div",3),t.OEk(7,"\u4ee3\u7406"),t.C$Y(),t.I0R(8,"div",4)(9,"span",5),t.qCj("click",function(){return r.toggleViewModel(r.viewModel)}),t.I0R(10,"mat-icon",6),t.OEk(11),t.C$Y()()()(),t.wR5(12,"app-proxy-card",7),t.wVc(13,"async"),t.C$Y()),2&o&&(t.yG2(3),t.E7m("policyGroups",t.kDX(4,4,r.policyGroups$)),t.yG2(8),t.cNF(r.viewModel),t.yG2(),t.E7m("proxies",t.kDX(13,6,r.proxies$))("viewModel",r.viewModel))},dependencies:[E.Y1,R.qL,Y,A,c.a],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%}.head[_ngcontent-%COMP%]{margin:16px 4px;font-size:24px;height:32px;line-height:32px;display:flex;color:#3f51b5}@media (prefers-color-scheme: dark){.head[_ngcontent-%COMP%]{color:#e91e63}}.head-right[_ngcontent-%COMP%], .head-left[_ngcontent-%COMP%]{flex:1 auto}"]})}return e})()}];let N=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275mod=t.a4G({type:e});static#e=this.\u0275inj=t.s3X({imports:[g.qQ.forChild(T),g.qQ]})}return e})();var z=i(7344),Q=i(6504);let B=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#o=this.\u0275mod=t.a4G({type:e});static#e=this.\u0275inj=t.s3X({imports:[c.MD,N,z.MaterialModule,O.F,Q.y]})}return e})()}}]);