"use strict";(self.webpackChunkng_clash=self.webpackChunkng_clash||[]).push([[144],{294:(T,M,n)=>{n.d(M,{I:()=>r});var m=n(6895),p=n(4650);let r=(()=>{class a{}return a.\u0275fac=function(h){return new(h||a)},a.\u0275mod=p.oAB({type:a}),a.\u0275inj=p.cJS({imports:[m.ez]}),a})()},7144:(T,M,n)=>{n.r(M),n.d(M,{DashboardModule:()=>w});var m=n(6895),p=n(5385),r=n(7337),a=(()=>{return(e=a||(a={})).proxies="proxies",e.logs="logs",e.rules="rules",e.links="links",e.settings="settings",a;var e})(),t=n(4650),h=n(8512),d=n(8226),c=n(4004),l=n(3151),s=n(2289),f=n(7392),i=n(4859),x=n(3683),v=n(3267);let S=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-loading"]],decls:1,vars:0,consts:[[1,"box"]],template:function(o,u){1&o&&t._UZ(0,"div",0)},styles:['@keyframes _ngcontent-%COMP%_rotar{0%{transform:rotate(0) scaleX(.82) scaleY(.82)}50%{transform:rotate(180deg) scaleX(1) scaleY(1)}to{transform:rotate(360deg) scaleX(.82) scaleY(.82)}}@keyframes _ngcontent-%COMP%_rotarIz{0%{transform:rotate(0) scaleX(.82) scaleY(.82)}50%{transform:rotate(-180deg) scaleX(1) scaleY(1)}to{transform:rotate(-360deg) scaleX(.82) scaleY(.82)}}.box[_ngcontent-%COMP%]{margin:4px;width:24px;height:24px;position:relative;z-index:99;box-sizing:border-box}.box[_ngcontent-%COMP%]:before, .box[_ngcontent-%COMP%]:after{content:"";border-radius:66%;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:center center}.box[_ngcontent-%COMP%]:before{box-shadow:inset 0 4px #00fafa99,inset 4px 0 #00c8c899,inset -4px 0 #0096c899,inset -4px 0 #00c8fa99;animation:_ngcontent-%COMP%_rotarIz 2s -.5s linear infinite}.box[_ngcontent-%COMP%]:after{box-shadow:inset 0 4px #fafa0099,inset 4px 0 #fac80099,inset -4px 0 #fa960099,inset -4px 0 #fa640099;animation:_ngcontent-%COMP%_rotar 2s -.5s linear infinite}']}),e})();const P=["*"];let E=(()=>{class e{ngOnInit(){}constructor(o){this.breakpointObserver=o,this.title="ng-clash",this.showSideNav=!1,this.isHandset$=this.breakpointObserver.observe(s.u3.Handset).pipe((0,c.U)(u=>u.matches),(0,l.d)())}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(s.Yg))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-layout"]],ngContentSelectors:P,decls:19,vars:9,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["color","primary",1,"toolbar"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],[1,"content"]],template:function(o,u){if(1&o){const C=t.EpF();t.F$t(),t.TgZ(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),t.ALo(3,"async"),t.ALo(4,"async"),t.ALo(5,"async"),t.TgZ(6,"mat-toolbar"),t._UZ(7,"app-loading"),t._uU(8,"Menu "),t.qZA(),t.Hsn(9),t.qZA(),t.TgZ(10,"mat-sidenav-content")(11,"mat-toolbar",3)(12,"button",4),t.NdJ("click",function(){t.CHM(C);const U=t.MAs(2);return t.KtG(U.toggle())}),t.TgZ(13,"mat-icon",5),t._uU(14,"menu"),t.qZA()(),t.TgZ(15,"span"),t._uU(16,"Ng-Clash"),t.qZA()(),t.TgZ(17,"div",6),t._UZ(18,"router-outlet"),t.qZA()()()}2&o&&(t.xp6(1),t.Q6J("mode",t.lcZ(4,5,u.isHandset$)?"over":"side")("opened",!1===t.lcZ(5,7,u.isHandset$)),t.uIk("role",t.lcZ(3,3,u.isHandset$)?"dialog":"navigation"))},dependencies:[r.lC,f.Hw,i.RK,x.Ye,v.JX,v.TM,v.Rh,S,m.Ov],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{box-sizing:border-box;min-height:calc(100% - 64px);padding:0 24px 24px}.toolbar[_ngcontent-%COMP%]{z-index:9!important}"]}),e})();var L=n(4633);function b(e,g){if(1&e){const o=t.EpF();t.ynx(0),t.TgZ(1,"mat-list-item",1),t.NdJ("click",function(){const O=t.CHM(o).$implicit,U=t.oxw();return t.KtG(U.onChange.emit(O))}),t.TgZ(2,"mat-icon",2),t._uU(3),t.qZA(),t.TgZ(4,"span",3),t._uU(5),t.qZA()(),t.BQk()}if(2&e){const o=g.$implicit;t.xp6(1),t.Q6J("activated",o.activated),t.xp6(2),t.Oqu(o.icon),t.xp6(2),t.hij(" ",o.name," ")}}let D=(()=>{class e{constructor(){this.navList=[],this.onChange=new t.vpe}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-menu"]],viewQuery:function(o,u){if(1&o&&t.Gf(L.Ub,5),2&o){let C;t.iGM(C=t.CRH())&&(u.matSelectionList=C.first)}},inputs:{navList:"navList"},outputs:{onChange:"onChange"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"activated","click"],["matListItemIcon",""],["matListItemTitle",""]],template:function(o,u){1&o&&(t.TgZ(0,"mat-nav-list"),t.YNc(1,b,6,3,"ng-container",0),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngForOf",u.navList))},dependencies:[m.sg,L.Hk,L.Tg,L.Yt,L.sL,f.Hw]}),e})();const I=[{path:"",component:(()=>{class e{handleSideNavActive(o){this.navList=this.toggleSideNavActiveStatus(this.navList,u=>u.value===o.value),this.router.navigate([o.value],{relativeTo:this.route})}toggleSideNavActiveStatus(o,u){return o.map(C=>(C.activated=!!u(C),C))}ngOnInit(){this.navList=this.toggleSideNavActiveStatus(this.navList,o=>location.pathname.includes(o.value)),this.logService.initLog(),this.connectionService.initConnection()}constructor(o,u,C,O){this.router=o,this.route=u,this.logService=C,this.connectionService=O,this.navList=[{name:"\u4ee3\u7406",value:a.proxies,icon:"vpn_key",activated:!0},{name:"\u65e5\u5fd7",value:a.logs,icon:"terminal",activated:!1},{name:"\u89c4\u5219",value:a.rules,icon:"rule",activated:!1},{name:"\u8fde\u63a5",value:a.links,icon:"link",activated:!1},{name:"\u8bbe\u7f6e",value:a.settings,icon:"settings",activated:!1}]}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(r.F0),t.Y36(r.gz),t.Y36(h.$),t.Y36(d.M))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard"]],decls:2,vars:1,consts:[[3,"navList","onChange"]],template:function(o,u){1&o&&(t.TgZ(0,"app-layout")(1,"app-menu",0),t.NdJ("onChange",function(O){return u.handleSideNavActive(O)}),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("navList",u.navList))},dependencies:[E,D]}),e})(),children:[{path:"",redirectTo:a.proxies,pathMatch:"full"},{path:a.proxies,loadChildren:()=>Promise.all([n.e(592),n.e(11)]).then(n.bind(n,3011)).then(e=>e.ClashProxyModule)},{path:a.rules,loadChildren:()=>Promise.all([n.e(592),n.e(776)]).then(n.bind(n,8776)).then(e=>e.ClashRulesModule)},{path:a.logs,loadChildren:()=>n.e(764).then(n.bind(n,5764)).then(e=>e.ClashLogsModule)},{path:a.links,loadChildren:()=>n.e(127).then(n.bind(n,3127)).then(e=>e.ClashLinksModule)},{path:a.settings,loadChildren:()=>Promise.all([n.e(592),n.e(685)]).then(n.bind(n,9685)).then(e=>e.ClashSettingsModule)}]}];let y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[r.Bz.forChild(I),r.Bz]}),e})();var A=n(294);let w=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,y,p.MaterialModule,A.I]}),e})()},1919:(T,M,n)=>{n.d(M,{i:()=>p});var m=(()=>{return(r=m||(m={}))[r.CONNECTING=0]="CONNECTING",r[r.OPEN=1]="OPEN",r[r.CLOSING=2]="CLOSING",r[r.CLOSED=3]="CLOSED",m;var r})();class p{constructor(a){this.connected=()=>{const s=this.instance;return!!s&&(s.readyState===m.CONNECTING||s.readyState===m.OPEN)},this.onClose=()=>{const s=this.instance;!s||!this.connected||(s.close(),this.instance=null)},this.onopen=s=>{console.log("webSocket \u5df2\u8fde\u63a5")},this.onclose=s=>{console.log("webSocket \u5df2\u5173\u95ed")},this.onmessage=s=>{console.log("\u{1f345} -> file: websocket.service.ts:67 -> WebsocketService -> data:",s)},this.onerror=s=>{console.log(s)},this.send=s=>{this.instance&&this.instance.send(JSON.stringify(s))};const{url:t,onopen:h,onerror:d,onclose:c,onmessage:l}=a;this.instance=new WebSocket(t),this.instance.onopen=h||this.onopen,this.instance.onerror=d||this.onerror,this.instance.onclose=c||this.onclose,this.instance.onmessage=l||this.onmessage}}},8226:(T,M,n)=>{n.d(M,{M:()=>t});var m=n(7579),p=n(1919),r=n(4650),a=n(535);let t=(()=>{class h{initConnection(){this.connection$.subscribe(c=>{this.connectionList=c})}constructor(c){this.hostService=c,this.connection$=new m.x,this.connectionList=null,new p.i({url:`ws://${this.hostService.host}:${this.hostService.port}/connections`,onmessage:x=>{let v=null;try{v=JSON.parse(x.data)}catch(S){console.log(S)}v&&this.connection$.next(v)}}).connected()}}return h.\u0275fac=function(c){return new(c||h)(r.LFG(a.x))},h.\u0275prov=r.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},8512:(T,M,n)=>{n.d(M,{$:()=>l});var m=n(5026),p=n(4004),r=n(7579),a=n(1919),t=n(4650),h=n(535);const c=()=>(0,m.R)((s,f)=>(s.unshift(f),s),[]);let l=(()=>{class s{initLog(){this.debug$.pipe((0,p.U)(i=>JSON.parse(i)),(0,p.U)(i=>({...i,time:new Date})),c()).subscribe(i=>{this.debugLog=i}),this.info$.pipe((0,p.U)(i=>JSON.parse(i)),(0,p.U)(i=>({...i,time:new Date})),c()).subscribe(i=>{this.infoLog=i}),this.warn$.pipe((0,p.U)(i=>JSON.parse(i)),(0,p.U)(i=>({...i,time:new Date})),c()).subscribe(i=>{this.warnLog=i}),this.error$.pipe((0,p.U)(i=>JSON.parse(i)),(0,p.U)(i=>({...i,time:new Date})),c()).subscribe(i=>{this.errorLog=i})}constructor(i){this.hostService=i,this.debug$=new r.x,this.info$=new r.x,this.warn$=new r.x,this.error$=new r.x,this.debugLog=[],this.infoLog=[],this.warnLog=[],this.errorLog=[];const x=this.hostService.host,v=this.hostService.port,S=`ws://${x}:${v}/logs?level=info`,P=`ws://${x}:${v}/logs?level=warn`,L=`ws://${x}:${v}/logs?level=error`,b=new a.i({url:`ws://${x}:${v}/logs?level=debug`,onmessage:y=>{this.debug$.next(y.data)}}),D=new a.i({url:S,onmessage:y=>{this.info$.next(y.data)}}),$=new a.i({url:P,onmessage:y=>{this.warn$.next(y.data)}}),I=new a.i({url:L,onmessage:y=>{this.error$.next(y.data)}});b.connected(),D.connected(),$.connected(),I.connected()}}return s.\u0275fac=function(i){return new(i||s)(t.LFG(h.x))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},3151:(T,M,n)=>{n.d(M,{d:()=>t});var m=n(7579),p=n(6063);class r extends m.x{constructor(d=1/0,c=1/0,l=p.l){super(),this._bufferSize=d,this._windowTime=c,this._timestampProvider=l,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=c===1/0,this._bufferSize=Math.max(1,d),this._windowTime=Math.max(1,c)}next(d){const{isStopped:c,_buffer:l,_infiniteTimeWindow:s,_timestampProvider:f,_windowTime:i}=this;c||(l.push(d),!s&&l.push(f.now()+i)),this._trimBuffer(),super.next(d)}_subscribe(d){this._throwIfClosed(),this._trimBuffer();const c=this._innerSubscribe(d),{_infiniteTimeWindow:l,_buffer:s}=this,f=s.slice();for(let i=0;i<f.length&&!d.closed;i+=l?1:2)d.next(f[i]);return this._checkFinalizedStatuses(d),c}_trimBuffer(){const{_bufferSize:d,_timestampProvider:c,_buffer:l,_infiniteTimeWindow:s}=this,f=(s?1:2)*d;if(d<1/0&&f<l.length&&l.splice(0,l.length-f),!s){const i=c.now();let x=0;for(let v=1;v<l.length&&l[v]<=i;v+=2)x=v;x&&l.splice(0,x+1)}}}var a=n(3099);function t(h,d,c){let l,s=!1;return h&&"object"==typeof h?({bufferSize:l=1/0,windowTime:d=1/0,refCount:s=!1,scheduler:c}=h):l=h??1/0,(0,a.B)({connector:()=>new r(l,d,c),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}}}]);